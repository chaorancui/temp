# CCE-CåŸ¹è®­è®¤è¯è¯¾ç¨‹ï¼ˆåˆçº§ï¼‰

[toc]



![](https://ilearning.huawei.com/edx/assets/courseware/v1/7df76efb8a9de3816c669b7bb25eb1c8/asset-v1:HuaweiX+CNE052301001461+Self-paced+type@asset+block/CCE-C%E5%9F%B9%E8%AE%AD%E8%AE%A4%E8%AF%81%E8%AF%BE%E7%A8%8B_%E5%88%9D%E7%BA%A7_.png)

## å¯¼å¼•ï¼šå¹¶è¡Œç¼–ç¨‹æ€ç»´





## æ¨¡å—ä¸€ï¼šDavinciåŸºæœ¬æ¶æ„è®²è§£





## æ¨¡å—äºŒï¼š



































# Docker å­¦ä¹ 

> [ä»€ä¹ˆæ˜¯Dockerï¼Ÿçœ‹è¿™ä¸€ç¯‡å¹²è´§æ–‡ç« å°±å¤Ÿäº†ï¼](https://zhuanlan.zhihu.com/p/187505981)

**ç›®çš„**

ä¸ºè§£å†³é‡å¤æ­å»ºå¼€å‘/æµ‹è¯•ç¯å¢ƒçš„é—®é¢˜ï¼Œåº”è¿è€Œç”Ÿçš„æŠ€æœ¯ã€‚



**å®¹å™¨æŠ€æœ¯ vs è™šæ‹Ÿæœº**

è™šæ‹Ÿæœº clone ä¹Ÿå¯ä»¥è§£å†³é—®é¢˜ï¼Œä½†è™šæ‹Ÿæœºéœ€è¦åŒæ­¥ clone æ“ä½œç³»ç»Ÿï¼Œå†…å­˜æµªè´¹ä¸”å¯åŠ¨æ…¢ã€‚å¯¹äº**ä»…éƒ¨ç½²åº”ç”¨ç¨‹åº**è¯‰æ±‚æ¥è¯´ï¼Œä¸æ˜¯æœ€ä¼˜è§£ã€‚



**ä»€ä¹ˆæ˜¯å®¹å™¨**

å®¹å™¨ä¸€è¯çš„è‹±æ–‡æ˜¯containerï¼Œå…¶å®containerè¿˜æœ‰é›†è£…ç®±çš„æ„æ€ï¼Œé›†è£…ç®±ç»å¯¹æ˜¯å•†ä¸šå²ä¸Šäº†ä¸èµ·çš„ä¸€é¡¹å‘æ˜ï¼Œå¤§å¤§é™ä½äº†æµ·æ´‹è´¸æ˜“è¿è¾“æˆæœ¬ã€‚è®©æˆ‘ä»¬æ¥çœ‹çœ‹é›†è£…ç®±çš„å¥½å¤„ï¼š

- é›†è£…ç®±ä¹‹é—´ç›¸äº’éš”ç¦»
- é•¿æœŸåå¤ä½¿ç”¨
- å¿«é€Ÿè£…è½½å’Œå¸è½½
- è§„æ ¼æ ‡å‡†ï¼Œåœ¨æ¸¯å£å’Œèˆ¹ä¸Šéƒ½å¯ä»¥æ‘†æ”¾

å›åˆ°è½¯ä»¶ä¸­çš„å®¹å™¨ï¼Œå…¶å®å®¹å™¨å’Œé›†è£…ç®±åœ¨æ¦‚å¿µä¸Šæ˜¯å¾ˆç›¸ä¼¼çš„ã€‚

ä¸è™šæ‹Ÿæœºé€šè¿‡æ“ä½œç³»ç»Ÿå®ç°éš”ç¦»ä¸åŒï¼Œå®¹å™¨æŠ€æœ¯**åªéš”ç¦»åº”ç”¨ç¨‹åºçš„è¿è¡Œæ—¶ç¯å¢ƒä½†å®¹å™¨ä¹‹é—´å¯ä»¥å…±äº«åŒä¸€ä¸ªæ“ä½œç³»ç»Ÿ**ï¼Œè¿™é‡Œçš„è¿è¡Œæ—¶ç¯å¢ƒæŒ‡çš„æ˜¯ç¨‹åºè¿è¡Œä¾èµ–çš„å„ç§åº“ä»¥åŠé…ç½®ã€‚

å®¹å™¨æ›´åŠ çš„**è½»é‡çº§ä¸”å ç”¨çš„èµ„æºæ›´å°‘**ï¼Œä¸æ“ä½œç³»ç»ŸåŠ¨è¾„å‡ Gçš„å†…å­˜å ç”¨ç›¸æ¯”ï¼Œå®¹å™¨æŠ€æœ¯åªéœ€æ•°Mç©ºé—´ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥åœ¨åŒæ ·è§„æ ¼çš„ç¡¬ä»¶ä¸Š**å¤§é‡éƒ¨ç½²å®¹å™¨**ï¼Œè¿™æ˜¯è™šæ‹Ÿæœºæ‰€ä¸èƒ½æ¯”æ‹Ÿçš„ï¼Œè€Œä¸”ä¸åŒäºæ“ä½œç³»ç»Ÿæ•°åˆ†é’Ÿçš„å¯åŠ¨æ—¶é—´å®¹å™¨å‡ ä¹ç¬æ—¶å¯åŠ¨ï¼Œå®¹å™¨æŠ€æœ¯ä¸º**æ‰“åŒ…æœåŠ¡æ ˆ**æä¾›äº†ä¸€ç§æ›´åŠ é«˜æ•ˆçš„æ–¹å¼ï¼ŒSo coolã€‚

é‚£ä¹ˆæˆ‘ä»¬è¯¥æ€ä¹ˆä½¿ç”¨å®¹å™¨å‘¢ï¼Ÿè¿™å°±è¦è®²åˆ°dockeräº†ã€‚

==æ³¨æ„ï¼Œ**å®¹å™¨æ˜¯ä¸€ç§é€šç”¨æŠ€æœ¯ï¼Œdockeråªæ˜¯å…¶ä¸­çš„ä¸€ç§å®ç°**ã€‚==



**ä»€ä¹ˆæ˜¯docker**

dockeræ˜¯ä¸€ä¸ªç”¨Goè¯­è¨€å®ç°çš„å¼€æºé¡¹ç›®ï¼Œå¯ä»¥è®©æˆ‘ä»¬æ–¹ä¾¿çš„åˆ›å»ºå’Œä½¿ç”¨å®¹å™¨ï¼Œdockerå°†ç¨‹åºä»¥åŠç¨‹åºæ‰€æœ‰çš„ä¾èµ–éƒ½æ‰“åŒ…åˆ°docker containerï¼Œè¿™æ ·ä½ çš„ç¨‹åºå¯ä»¥åœ¨ä»»ä½•ç¯å¢ƒéƒ½ä¼šæœ‰ä¸€è‡´çš„è¡¨ç°ï¼Œè¿™é‡Œç¨‹åºè¿è¡Œçš„ä¾èµ–ä¹Ÿå°±æ˜¯å®¹å™¨å°±å¥½æ¯”é›†è£…ç®±ï¼Œå®¹å™¨æ‰€å¤„çš„æ“ä½œç³»ç»Ÿç¯å¢ƒå°±å¥½æ¯”è´§èˆ¹æˆ–æ¸¯å£ï¼Œ**ç¨‹åºçš„è¡¨ç°åªå’Œé›†è£…ç®±æœ‰å…³ç³»(å®¹å™¨)ï¼Œå’Œé›†è£…ç®±æ”¾åœ¨å“ªä¸ªè´§èˆ¹æˆ–è€…å“ªä¸ªæ¸¯å£(æ“ä½œç³»ç»Ÿ)æ²¡æœ‰å…³ç³»**ã€‚

å› æ­¤æˆ‘ä»¬å¯ä»¥çœ‹åˆ°dockerå¯ä»¥å±è”½ç¯å¢ƒå·®å¼‚ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåªè¦ä½ çš„ç¨‹åºæ‰“åŒ…åˆ°äº†dockerä¸­ï¼Œé‚£ä¹ˆæ— è®ºè¿è¡Œåœ¨ä»€ä¹ˆç¯å¢ƒä¸‹ç¨‹åºçš„è¡Œä¸ºéƒ½æ˜¯ä¸€è‡´çš„ï¼Œç¨‹åºå‘˜å†ä¹Ÿæ— æ³•æ–½å±•è¡¨æ¼”æ‰åäº†ï¼Œ**ä¸ä¼šå†æœ‰â€œåœ¨æˆ‘çš„ç¯å¢ƒä¸Šå¯ä»¥è¿è¡Œâ€**ï¼ŒçœŸæ­£å®ç°â€œbuild once, run everywhereâ€ã€‚

æ­¤å¤–dockerçš„å¦ä¸€ä¸ªå¥½å¤„å°±æ˜¯**å¿«é€Ÿéƒ¨ç½²**ï¼Œè¿™æ˜¯å½“å‰äº’è”ç½‘å…¬å¸æœ€å¸¸è§çš„ä¸€ä¸ªåº”ç”¨åœºæ™¯ï¼Œä¸€ä¸ªåŸå› åœ¨äºå®¹å™¨å¯åŠ¨é€Ÿåº¦éå¸¸å¿«ï¼Œå¦ä¸€ä¸ªåŸå› åœ¨äºåªè¦ç¡®ä¿ä¸€ä¸ªå®¹å™¨ä¸­çš„ç¨‹åºæ­£ç¡®è¿è¡Œï¼Œé‚£ä¹ˆä½ å°±èƒ½ç¡®ä¿¡æ— è®ºåœ¨ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²å¤šå°‘éƒ½èƒ½æ­£ç¡®è¿è¡Œã€‚



**å¦‚ä½•ä½¿ç”¨docker**

dockerä¸­æœ‰è¿™æ ·å‡ ä¸ªæ¦‚å¿µï¼š

- dockerfile
- image
- container

å®é™…ä¸Šä½ å¯ä»¥ç®€å•çš„æŠŠimageç†è§£ä¸ºå¯æ‰§è¡Œç¨‹åºï¼Œcontainerå°±æ˜¯è¿è¡Œèµ·æ¥çš„è¿›ç¨‹ã€‚

é‚£ä¹ˆå†™ç¨‹åºéœ€è¦æºä»£ç ï¼Œé‚£ä¹ˆâ€œå†™â€imageå°±éœ€è¦dockerfileï¼Œdockerfileå°±æ˜¯imageçš„æºä»£ç ï¼Œdockerå°±æ˜¯"ç¼–è¯‘å™¨"ã€‚

å› æ­¤æˆ‘ä»¬åªéœ€è¦åœ¨dockerfileä¸­æŒ‡å®šéœ€è¦å“ªäº›ç¨‹åºã€ä¾èµ–ä»€ä¹ˆæ ·çš„é…ç½®ï¼Œä¹‹åæŠŠdockerfileäº¤ç»™â€œç¼–è¯‘å™¨â€dockerè¿›è¡Œâ€œç¼–è¯‘â€ï¼Œä¹Ÿå°±æ˜¯docker buildå‘½ä»¤ï¼Œç”Ÿæˆçš„å¯æ‰§è¡Œç¨‹åºå°±æ˜¯imageï¼Œä¹‹åå°±å¯ä»¥è¿è¡Œè¿™ä¸ªimageäº†ï¼Œè¿™å°±æ˜¯docker runå‘½ä»¤ï¼Œimageè¿è¡Œèµ·æ¥åå°±æ˜¯docker containerã€‚

å…·ä½“çš„ä½¿ç”¨æ–¹æ³•å°±ä¸å†è¿™é‡Œèµ˜è¿°äº†ï¼Œå¤§å®¶å¯ä»¥å‚è€ƒdockerçš„å®˜æ–¹æ–‡æ¡£ï¼Œé‚£é‡Œæœ‰è¯¦ç»†çš„è®²è§£ã€‚



**dockeræ˜¯å¦‚ä½•å·¥ä½œçš„**

å®é™…ä¸Šdockerä½¿ç”¨äº†å¸¸è§çš„CSæ¶æ„ï¼Œä¹Ÿå°±æ˜¯client-serveræ¨¡å¼ï¼Œdocker clientè´Ÿè´£å¤„ç†ç”¨æˆ·è¾“å…¥çš„å„ç§å‘½ä»¤ï¼Œæ¯”å¦‚`docker build`ã€`docker run`ï¼ŒçœŸæ­£å·¥ä½œçš„å…¶å®æ˜¯ serverï¼Œä¹Ÿå°±æ˜¯ docker daemonï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œdocker client å’Œ docker daemon å¯ä»¥è¿è¡Œåœ¨åŒä¸€å°æœºå™¨ä¸Šã€‚

æ¥ä¸‹æ¥æˆ‘ä»¬ç”¨å‡ ä¸ªå‘½ä»¤æ¥è®²è§£ä¸€ä¸‹dockerçš„å·¥ä½œæµç¨‹ï¼š



**1ï¼Œdocker build**

å½“æˆ‘ä»¬å†™å®Œdockerfileäº¤ç»™dockerâ€œç¼–è¯‘â€æ—¶ä½¿ç”¨è¿™ä¸ªå‘½ä»¤ï¼Œé‚£ä¹ˆclientåœ¨æ¥æ”¶åˆ°è¯·æ±‚åè½¬å‘ç»™docker daemonï¼Œæ¥ç€docker daemonæ ¹æ®dockerfileåˆ›å»ºå‡ºâ€œå¯æ‰§è¡Œç¨‹åºâ€imageã€‚

![img](https://pic3.zhimg.com/80/v2-f16577a98471b4c4b5b1af1036882caa_720w.webp)



**2ï¼Œdocker run**

æœ‰äº†â€œå¯æ‰§è¡Œç¨‹åºâ€imageåå°±å¯ä»¥è¿è¡Œç¨‹åºäº†ï¼Œæ¥ä¸‹æ¥ä½¿ç”¨å‘½ä»¤docker runï¼Œdocker daemonæ¥æ”¶åˆ°è¯¥å‘½ä»¤åæ‰¾åˆ°å…·ä½“çš„imageï¼Œç„¶ååŠ è½½åˆ°å†…å­˜å¼€å§‹æ‰§è¡Œï¼Œimageæ‰§è¡Œèµ·æ¥å°±æ˜¯æ‰€è°“çš„containerã€‚

![img](https://pic4.zhimg.com/80/v2-672b29e2d53d2ab044269b026c6bc473_720w.webp)



**3ï¼Œdocker pull**

å…¶å®docker buildå’Œdocker runæ˜¯ä¸¤ä¸ªæœ€æ ¸å¿ƒçš„å‘½ä»¤ï¼Œä¼šç”¨è¿™ä¸¤ä¸ªå‘½ä»¤åŸºæœ¬ä¸Šdockerå°±å¯ä»¥ç”¨èµ·æ¥äº†ï¼Œå‰©ä¸‹çš„å°±æ˜¯ä¸€äº›è¡¥å……ã€‚

é‚£ä¹ˆdocker pullæ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿ

æˆ‘ä»¬ä¹‹å‰è¯´è¿‡ï¼Œdockerä¸­imageçš„æ¦‚å¿µå°±ç±»ä¼¼äºâ€œå¯æ‰§è¡Œç¨‹åºâ€ï¼Œæˆ‘ä»¬å¯ä»¥ä»å“ªé‡Œä¸‹è½½åˆ°åˆ«äººå†™å¥½çš„åº”ç”¨ç¨‹åºå‘¢ï¼Ÿå¾ˆç®€å•ï¼Œé‚£å°±æ˜¯APP Storeï¼Œå³åº”ç”¨å•†åº—ã€‚ä¸ä¹‹ç±»ä¼¼ï¼Œæ—¢ç„¶imageä¹Ÿæ˜¯ä¸€ç§â€œå¯æ‰§è¡Œç¨‹åºâ€ï¼Œé‚£ä¹ˆæœ‰æ²¡æœ‰"Docker Image Store"å‘¢ï¼Ÿç­”æ¡ˆæ˜¯è‚¯å®šçš„ï¼Œè¿™å°±æ˜¯Docker Hubï¼Œdockerå®˜æ–¹çš„â€œåº”ç”¨å•†åº—â€ï¼Œä½ å¯ä»¥åœ¨è¿™é‡Œä¸‹è½½åˆ°åˆ«äººç¼–å†™å¥½çš„imageï¼Œè¿™æ ·ä½ å°±ä¸ç”¨è‡ªå·±ç¼–å†™dockerfileäº†ã€‚

docker registry å¯ä»¥ç”¨æ¥å­˜æ”¾å„ç§imageï¼Œå…¬å…±çš„å¯ä»¥ä¾›ä»»ä½•äººä¸‹è½½imageçš„ä»“åº“å°±æ˜¯docker Hubã€‚é‚£ä¹ˆè¯¥æ€ä¹ˆä»Docker Hubä¸­ä¸‹è½½imageå‘¢ï¼Œå°±æ˜¯è¿™é‡Œçš„docker pullå‘½ä»¤äº†ã€‚

å› æ­¤ï¼Œè¿™ä¸ªå‘½ä»¤çš„å®ç°ä¹Ÿå¾ˆç®€å•ï¼Œé‚£å°±æ˜¯ç”¨æˆ·é€šè¿‡docker clientå‘é€å‘½ä»¤ï¼Œdocker daemonæ¥æ”¶åˆ°å‘½ä»¤åå‘docker registryå‘é€imageä¸‹è½½è¯·æ±‚ï¼Œä¸‹è½½åå­˜æ”¾åœ¨æœ¬åœ°ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨imageäº†ã€‚



**dockerçš„åº•å±‚å®ç°**

dockeråŸºäºLinuxå†…æ ¸æä¾›è¿™æ ·å‡ é¡¹åŠŸèƒ½å®ç°çš„ï¼š

- **NameSpace**
  æˆ‘ä»¬çŸ¥é“Linuxä¸­çš„PIDã€IPCã€ç½‘ç»œç­‰èµ„æºæ˜¯å…¨å±€çš„ï¼Œè€ŒNameSpaceæœºåˆ¶æ˜¯ä¸€ç§èµ„æºéš”ç¦»æ–¹æ¡ˆï¼Œåœ¨è¯¥æœºåˆ¶ä¸‹è¿™äº›èµ„æºå°±ä¸å†æ˜¯å…¨å±€çš„äº†ï¼Œè€Œæ˜¯å±äºæŸä¸ªç‰¹å®šçš„NameSpaceï¼Œå„ä¸ªNameSpaceä¸‹çš„èµ„æºäº’ä¸å¹²æ‰°ï¼Œè¿™å°±ä½¿å¾—æ¯ä¸ªNameSpaceçœ‹ä¸Šå»å°±åƒä¸€ä¸ªç‹¬ç«‹çš„æ“ä½œç³»ç»Ÿä¸€æ ·ï¼Œä½†æ˜¯åªæœ‰NameSpaceæ˜¯ä¸å¤Ÿã€‚
- **Control groups**
  è™½ç„¶æœ‰äº†NameSpaceæŠ€æœ¯å¯ä»¥å®ç°èµ„æºéš”ç¦»ï¼Œä½†è¿›ç¨‹è¿˜æ˜¯å¯ä»¥ä¸å—æ§çš„è®¿é—®ç³»ç»Ÿèµ„æºï¼Œæ¯”å¦‚CPUã€å†…å­˜ã€ç£ç›˜ã€ç½‘ç»œç­‰ï¼Œä¸ºäº†æ§åˆ¶å®¹å™¨ä¸­è¿›ç¨‹å¯¹èµ„æºçš„è®¿é—®ï¼ŒDockeré‡‡ç”¨control groupsæŠ€æœ¯(ä¹Ÿå°±æ˜¯cgroup)ï¼Œæœ‰äº†cgroupå°±å¯ä»¥æ§åˆ¶å®¹å™¨ä¸­è¿›ç¨‹å¯¹ç³»ç»Ÿèµ„æºçš„æ¶ˆè€—äº†ï¼Œæ¯”å¦‚ä½ å¯ä»¥é™åˆ¶æŸä¸ªå®¹å™¨ä½¿ç”¨å†…å­˜çš„ä¸Šé™ã€å¯ä»¥åœ¨å“ªäº›CPUä¸Šè¿è¡Œç­‰ç­‰ã€‚

æœ‰äº†è¿™ä¸¤é¡¹æŠ€æœ¯ï¼Œå®¹å™¨çœ‹èµ·æ¥å°±çœŸçš„åƒæ˜¯ç‹¬ç«‹çš„æ“ä½œç³»ç»Ÿäº†ã€‚

> è¯´æ˜ï¼š
>
> â€œçœŸæ­£å®ç°â€œbuild once, run everywhereâ€â€ã€‚è¿™å¥è¯æ˜¯é”™è¯¯çš„ï¼Œå®é™…ä¸Šç¨‹åºå‘˜ä¾ç„¶æœ‰æ¼”æˆçš„ç©ºé—´ã€‚å› ä¸ºå®¹å™¨åªæ‰“åŒ…äº†ç”¨æˆ·ç©ºé—´çš„ç³»ç»Ÿè°ƒç”¨ï¼Œæ‰§è¡Œç³»ç»Ÿè°ƒç”¨çš„åœ°æ–¹ä¾ç„¶æ˜¯å®¿ä¸»çš„kernelï¼Œæ‰€ä»¥å½“ä½ docker run centos:6 bashæ‰§è¡Œè¿™å¥è¯çš„æ—¶å€™ï¼Œåœ¨æ–°çš„å†…æ ¸ä¸Šå¯èƒ½ä¼šå‘ç”Ÿæ®µé”™è¯¯ï¼Œè€Œè€çš„å®¿ä¸»æœºå´ä¸ä¼šã€‚**çœŸæ­£è¦åšåˆ°BOREï¼Œè¿˜æ˜¯å¿…ä½¿ç”¨åŒæ ·çš„å†…æ ¸**ï¼Œé‚£æ ·çš„è¯ï¼Œå’Œä½¿ç”¨è™šæ‹Ÿæœºå°±æ²¡å·®åˆ«äº†ã€‚æ€»ä¹‹ä¸å¯èƒ½åšåˆ°å¼€å‘ï¼Œæµ‹è¯•ï¼Œè¿ç»´åªè¦ç”¨åŒä¸€ä¸ªé•œåƒå°±èƒ½è¡¨ç°å®Œå…¨ä¸€è‡´ï¼Œåªè¦æä¾›ç³»ç»Ÿè°ƒç”¨çš„å†…æ ¸ç‰ˆæœ¬ä¸åŒï¼Œå—¯ï¼Œè¡Œä¸ºå°±ç»å¯¹ä¸èƒ½ä¿è¯ä¸€è‡´ã€‚



# **Docker å¿«é€Ÿå…¥é—¨**

> [**Docker å¿«é€Ÿå…¥é—¨**](https://docker.easydoc.net/doc/81170005/cCewZWoN/lTKfePfP)
>
> [Docker â€” ä»å…¥é—¨åˆ°å®è·µ](https://yeasy.gitbook.io/docker_practice)

Docker æ˜¯ä¸€ä¸ªåº”ç”¨æ‰“åŒ…ã€åˆ†å‘ã€éƒ¨ç½²çš„å·¥å…·
ä½ ä¹Ÿå¯ä»¥æŠŠå®ƒç†è§£ä¸ºä¸€ä¸ªè½»é‡çš„è™šæ‹Ÿæœºï¼Œå®ƒåªè™šæ‹Ÿä½ è½¯ä»¶éœ€è¦çš„è¿è¡Œç¯å¢ƒï¼Œå¤šä½™çš„ä¸€ç‚¹éƒ½ä¸è¦ï¼Œ
è€Œæ™®é€šè™šæ‹Ÿæœºåˆ™æ˜¯ä¸€ä¸ªå®Œæ•´è€Œåºå¤§çš„ç³»ç»Ÿï¼ŒåŒ…å«å„ç§ä¸ç®¡ä½ è¦ä¸è¦çš„è½¯ä»¶ã€‚

### æ‰“åŒ…ã€åˆ†å‘ã€éƒ¨ç½²

**æ‰“åŒ…**ï¼šå°±æ˜¯æŠŠä½ è½¯ä»¶è¿è¡Œæ‰€éœ€çš„**ä¾èµ–**ã€**ç¬¬ä¸‰æ–¹åº“**ã€**è½¯ä»¶**æ‰“åŒ…åˆ°ä¸€èµ·ï¼Œå˜æˆä¸€ä¸ªå®‰è£…åŒ…
**åˆ†å‘**ï¼šä½ å¯ä»¥æŠŠä½ æ‰“åŒ…å¥½çš„â€œå®‰è£…åŒ…â€ä¸Šä¼ åˆ°ä¸€ä¸ªé•œåƒä»“åº“ï¼Œå…¶ä»–äººå¯ä»¥éå¸¸æ–¹ä¾¿çš„è·å–å’Œå®‰è£…
**éƒ¨ç½²**ï¼šæ‹¿ç€â€œå®‰è£…åŒ…â€å°±å¯ä»¥ä¸€ä¸ªå‘½ä»¤è¿è¡Œèµ·æ¥ä½ çš„åº”ç”¨ï¼Œè‡ªåŠ¨æ¨¡æ‹Ÿå‡ºä¸€æ‘¸ä¸€æ ·çš„è¿è¡Œç¯å¢ƒï¼Œä¸ç®¡æ˜¯åœ¨ Windows/Mac/Linuxã€‚

### Docker é€šå¸¸ç”¨æ¥åšä»€ä¹ˆ

- åº”ç”¨åˆ†å‘ã€éƒ¨ç½²ï¼Œæ–¹ä¾¿ä¼ æ’­ç»™ä»–äººå®‰è£…ã€‚ç‰¹åˆ«æ˜¯å¼€æºè½¯ä»¶å’Œæä¾›ç§æœ‰éƒ¨ç½²çš„åº”ç”¨
- å¿«é€Ÿå®‰è£…æµ‹è¯•/å­¦ä¹ è½¯ä»¶ï¼Œç”¨å®Œå°±ä¸¢ï¼ˆç±»ä¼¼å°ç¨‹åºï¼‰ï¼Œä¸æŠŠæ—¶é—´æµªè´¹åœ¨å®‰è£…è½¯ä»¶ä¸Šã€‚ä¾‹å¦‚ Redis / MongoDB / ElasticSearch / ELK
- å¤šä¸ªç‰ˆæœ¬è½¯ä»¶å…±å­˜ï¼Œä¸æ±¡æŸ“ç³»ç»Ÿï¼Œä¾‹å¦‚ Python2ã€Python3ï¼ŒRedis4.0ï¼ŒRedis5.0
- Windows ä¸Šä½“éªŒ/å­¦ä¹ å„ç§ Linux ç³»ç»Ÿ

### **Docker** åŒ…æ‹¬ä¸‰ä¸ªåŸºæœ¬æ¦‚å¿µï¼šé•œåƒã€å®¹å™¨ã€ä»“åº“

-  é•œåƒï¼ˆ`Image`ï¼‰ï¼šDocker é•œåƒæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„æ–‡ä»¶ç³»ç»Ÿï¼Œé™¤äº†æä¾›[å®¹å™¨](https://cloud.tencent.com/product/tke?from_column=20065&from=20065)è¿è¡Œæ—¶æ‰€éœ€çš„ç¨‹åºã€åº“ã€èµ„æºã€é…ç½®ç­‰æ–‡ä»¶å¤–ï¼Œè¿˜åŒ…å«äº†ä¸€äº›ä¸ºè¿è¡Œæ—¶å‡†å¤‡çš„ä¸€äº›é…ç½®å‚æ•°ï¼ˆå¦‚åŒ¿åå·ã€ç¯å¢ƒå˜é‡ã€ç”¨æˆ·ç­‰ï¼‰ã€‚é•œåƒä¸åŒ…å«ä»»ä½•åŠ¨æ€æ•°æ®ï¼Œå…¶å†…å®¹åœ¨æ„å»ºä¹‹åä¹Ÿä¸ä¼šè¢«æ”¹å˜ã€‚ 
-  å®¹å™¨ï¼ˆ`Container`ï¼‰ï¼šé•œåƒï¼ˆ`Image`ï¼‰å’Œå®¹å™¨ï¼ˆ`Container`ï¼‰çš„å…³ç³»ï¼Œå°±åƒæ˜¯é¢å‘å¯¹è±¡ç¨‹åºè®¾è®¡ä¸­çš„ `ç±»` å’Œ `å®ä¾‹` ä¸€æ ·ï¼Œé•œåƒæ˜¯é™æ€çš„å®šä¹‰ï¼Œå®¹å™¨æ˜¯é•œåƒè¿è¡Œæ—¶çš„å®ä½“ã€‚å®¹å™¨å¯ä»¥è¢«åˆ›å»ºã€å¯åŠ¨ã€åœæ­¢ã€åˆ é™¤ã€æš‚åœç­‰ã€‚ 
-  ä»“åº“ï¼ˆ`Repository`ï¼‰ï¼šä»“åº“ï¼ˆ`Repository`ï¼‰ç±»ä¼¼Gitçš„è¿œç¨‹ä»“åº“ï¼Œé›†ä¸­å­˜æ”¾é•œåƒæ–‡ä»¶ã€‚ 

ä¸‰è€…å…³ç³»å¯ä»¥ç”¨ä¸‹å›¾è¡¨ç¤ºï¼š

![Docker](https://ask.qcloudimg.com/http-save/yehe-7565276/joa65awgh4.png)







# éœ‡æƒŠğŸ˜± è¶…è¯¦ç»†çš„ Docker å¸¸ç”¨å‘½ä»¤

> [éœ‡æƒŠğŸ˜± è¶…è¯¦ç»†çš„ Docker å¸¸ç”¨å‘½ä»¤](https://juejin.cn/post/7245275769219203132)
>
> [ä¸€å¼ è„‘å›¾æ•´ç†Dockerå¸¸ç”¨å‘½ä»¤](https://cloud.tencent.com/developer/article/1772136)

![Docker](https://ask.qcloudimg.com/http-save/yehe-7565276/6lldlbgfhn.png)



## æœåŠ¡ç›¸å…³å‘½ä»¤

```shell
# å¯åŠ¨ docker æœåŠ¡
systemctl start docker

# åœæ­¢ docker æœåŠ¡
systemctl stop docker

# é‡å¯ docker æœåŠ¡
systemctl restart docker

# æŸ¥çœ‹ docker æœåŠ¡çŠ¶æ€
systemctl status docker

# è®¾ç½®å¼€æœºå¯åŠ¨ docker æœåŠ¡
systemctl enable docker
```



## é•œåƒç›¸å…³å‘½ä»¤

**æœç´¢é•œåƒ**

```shell
# ä»Docker HubæŸ¥æ‰¾é•œåƒ
docker search [OPTIONS] TERM

--automated :åªåˆ—å‡º automated buildç±»å‹çš„é•œåƒï¼›
--no-trunc :æ˜¾ç¤ºå®Œæ•´çš„é•œåƒæè¿°ï¼›
-f <è¿‡æ»¤æ¡ä»¶>:åˆ—å‡ºæ”¶è—æ•°ä¸å°äºæŒ‡å®šå€¼çš„é•œåƒã€‚

# ä¾‹ï¼š
docker search -f stars=10 java # ä» Docker Hub æŸ¥æ‰¾æ‰€æœ‰é•œåƒååŒ…å« javaï¼Œå¹¶ä¸”æ”¶è—æ•°å¤§äº 10 çš„é•œåƒ
```



**æ‹‰å–é•œåƒ**

```shell
# ä»é•œåƒä»“åº“ä¸­æ‹‰å–æˆ–è€…æ›´æ–°æŒ‡å®šé•œåƒ
docker pull [OPTIONS] NAME[:TAG|@DIGEST]

-a :æ‹‰å–æ‰€æœ‰ tagged é•œåƒ
--disable-content-trust :å¿½ç•¥é•œåƒçš„æ ¡éªŒ,é»˜è®¤å¼€å¯

# ä¾‹ï¼š
docker pull java # ä»Docker Hubä¸‹è½½javaæœ€æ–°ç‰ˆé•œåƒ
```

> tip:
>
> ```shell
> # æŒ‡å®šç‰ˆæœ¬å·, æ ¼å¼å¦‚ä¸‹
> docker pull é•œåƒå:ç‰ˆæœ¬å·tag
> ```
>
> ä¸åŠ  `tag` çš„æƒ…å†µä¸‹, é»˜è®¤æ‹‰å–çš„å°±æ˜¯ `latest`(æœ€æ–°ç‰ˆæœ¬)ï¼Œå¦‚æœä¸çŸ¥é“ `tag` æœ‰å“ªäº›, å¯ä»¥å» [`Dockerhub`](https://link.juejin.cn/?target=https%3A%2F%2Fhub.docker.com) æŸ¥çœ‹



**ä½¿ç”¨`Dockerfile`æ„å»ºé•œåƒ**

```shell
# docker build å‘½ä»¤ç”¨äºä½¿ç”¨ Dockerfile åˆ›å»ºé•œåƒ

docker build [OPTIONS] PATH | URL | -

--build-arg=[] :è®¾ç½®é•œåƒåˆ›å»ºæ—¶çš„å˜é‡ï¼›
--cpu-shares :è®¾ç½® cpu ä½¿ç”¨æƒé‡ï¼›
--cpu-period :é™åˆ¶ CPU CFSå‘¨æœŸï¼›
--cpu-quota :é™åˆ¶ CPU CFSé…é¢ï¼›
--cpuset-cpus :æŒ‡å®šä½¿ç”¨çš„CPU idï¼›
--cpuset-mems :æŒ‡å®šä½¿ç”¨çš„å†…å­˜ idï¼›
--disable-content-trust :å¿½ç•¥æ ¡éªŒï¼Œé»˜è®¤å¼€å¯ï¼›
-f :æŒ‡å®šè¦ä½¿ç”¨çš„Dockerfileè·¯å¾„ï¼›
--force-rm :è®¾ç½®é•œåƒè¿‡ç¨‹ä¸­åˆ é™¤ä¸­é—´å®¹å™¨ï¼›
--isolation :ä½¿ç”¨å®¹å™¨éš”ç¦»æŠ€æœ¯ï¼›
--label=[] :è®¾ç½®é•œåƒä½¿ç”¨çš„å…ƒæ•°æ®ï¼›
-m :è®¾ç½®å†…å­˜æœ€å¤§å€¼ï¼›
--memory-swap :è®¾ç½®Swapçš„æœ€å¤§å€¼ä¸ºå†…å­˜+swapï¼Œ"-1"è¡¨ç¤ºä¸é™swapï¼›
--no-cache :åˆ›å»ºé•œåƒçš„è¿‡ç¨‹ä¸ä½¿ç”¨ç¼“å­˜ï¼›
--pull :å°è¯•å»æ›´æ–°é•œåƒçš„æ–°ç‰ˆæœ¬ï¼›
--quiet, -q :å®‰é™æ¨¡å¼ï¼ŒæˆåŠŸååªè¾“å‡ºé•œåƒ IDï¼›
--rm :è®¾ç½®é•œåƒæˆåŠŸååˆ é™¤ä¸­é—´å®¹å™¨ï¼›
--shm-size :è®¾ç½®/dev/shmçš„å¤§å°ï¼Œé»˜è®¤å€¼æ˜¯64Mï¼›
--ulimit :Ulimité…ç½®ã€‚
--squash :å°† Dockerfile ä¸­æ‰€æœ‰çš„æ“ä½œå‹ç¼©ä¸ºä¸€å±‚ã€‚
--tag, -t: é•œåƒçš„åå­—åŠæ ‡ç­¾ï¼Œé€šå¸¸ name:tag æˆ–è€… name æ ¼å¼ï¼›å¯ä»¥åœ¨ä¸€æ¬¡æ„å»ºä¸­ä¸ºä¸€ä¸ªé•œåƒè®¾ç½®å¤šä¸ªæ ‡ç­¾ã€‚
--network: é»˜è®¤ defaultã€‚åœ¨æ„å»ºæœŸé—´è®¾ç½®RUNæŒ‡ä»¤çš„ç½‘ç»œæ¨¡å¼

# ä¾‹ï¼š
# ä½¿ç”¨å½“å‰ç›®å½•çš„ Dockerfile åˆ›å»ºé•œåƒï¼Œæ ‡ç­¾ä¸º runoob/ubuntu:v1ã€‚æ³¨æ„æœ€åè¾¹çš„ç‚¹ `.` è¡¨ç¤ºå½“å‰ç›®å½•, åˆ«ä¸¢äº†
docker build -t runoob/ubuntu:v1 . 

# ä½¿ç”¨URL github.com/creack/docker-firefox çš„ Dockerfile åˆ›å»ºé•œåƒã€‚
docker build github.com/creack/docker-firefox

# ä¹Ÿå¯ä»¥é€šè¿‡ -f Dockerfile æ–‡ä»¶çš„ä½ç½®ï¼š
docker build -f /path/to/a/Dockerfile .
```

`Docker` `build` å‘½ä»¤å¯ä»¥ä½¿ç”¨ `Dockerfile` æ¥æ„å»ºé•œåƒã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œ`Dockerfile` æ–‡ä»¶ä½äºæ„å»ºä¸Šä¸‹æ–‡çš„æ ¹ç›®å½•ä¸‹ï¼Œå› æ­¤ `docker build` å‘½ä»¤ä¼šè‡ªåŠ¨è¯»å–ä¸Šä¸‹æ–‡æ ¹è·¯å¾„ä¸‹åä¸º `Dockerfile` çš„æ–‡ä»¶ã€‚å¦‚æœ `Dockerfile` æ–‡ä»¶ä¸åœ¨æ ¹ç›®å½•ä¸‹ï¼Œå¯ä»¥ä½¿ç”¨ `-f` é€‰é¡¹æ¥æŒ‡å®š `Dockerfile` æ–‡ä»¶çš„è·¯å¾„ã€‚ä¾‹å¦‚ï¼Œä»¥ä¸‹å‘½ä»¤å°†ä½¿ç”¨ `/path/to/Dockerfile` æ–‡ä»¶æ„å»ºé•œåƒï¼š

```shell
docker build -f /path/to/Dockerfile -t image_name:tag .
```

å…¶ä¸­ï¼Œ

- `.` è¡¨ç¤ºå½“å‰ç›®å½•.
- `-f` , `--file` Name of the Dockerfile (Default is PATH/Dockerfile)
- `-t` , `--tag` Name and optionally a tag in the name:tag format

[docker build [OPTIONS\]æ–‡æ¡£](https://link.juejin.cn/?target=https%3A%2F%2Fdocs.docker.com%2Fengine%2Freference%2Fcommandline%2Fbuild%2F%23options)

`Dockerfile` ç®€å•åˆ—ä¸¾å‡ ä¸ªæŒ‡ä»¤:

- `FROM` : æŒ‡å®šåŸºç¡€é•œåƒ
- `WORKDIR` : æŒ‡å®šå·¥ä½œç›®å½•
- `COPY` : å°†æ–‡ä»¶æˆ–è€…ç›®å½•ä»æ„å»ºä¸Šä¸‹æ–‡å¤åˆ¶åˆ°å®¹å™¨ä¸­(æ¨è)
- `ADD` : å°†æ–‡ä»¶æˆ–è€…ç›®å½•ä»æ„å»ºä¸Šä¸‹æ–‡å¤åˆ¶åˆ°å®¹å™¨ä¸­,å¹¶ä¸”ä¼šå°†å‹ç¼©æ–‡ä»¶è§£å‹ç¼©,æ”¯æŒ `URL`
- `RUN` : åœ¨å®¹å™¨ä¸­æ‰§è¡Œå‘½ä»¤
- `CMD` : å®¹å™¨å¯åŠ¨æ—¶æ‰§è¡Œçš„å‘½ä»¤
- `EXPOSE` : æŒ‡å®šè¦ç›‘å¬çš„ç«¯å£ä»¥å®ç°ä¸å¤–éƒ¨é€šä¿¡

ä¸¾ä¸ªä¾‹å­:

```Dockerfile
# nodejs server Dockerfile

# FROM node
# or
FROM node:16

WORKDIR /nodeApp

# COPY <å®¿ä¸»æœºç›®å½•æˆ–æ–‡ä»¶è·¯å¾„> <å®¹å™¨å†…ç›®å½•æˆ–æ–‡ä»¶è·¯å¾„>
COPY ./package.json .
# ADD <å®¿ä¸»æœºç›®å½•æˆ–æ–‡ä»¶è·¯å¾„> <å®¹å™¨å†…ç›®å½•æˆ–æ–‡ä»¶è·¯å¾„>
# ADD ./package.json .

# shellæ ¼å¼ï¼šå°±åƒåœ¨å‘½ä»¤è¡Œä¸­è¾“å…¥çš„Shellè„šæœ¬å‘½ä»¤ä¸€æ ·ã€‚
RUN npm install

COPY ./src ./server

EXPOSE 8000

CMD ["node", "./server/index.js"]
```

è¯¦ç»†äº†è§£è¯·æŸ¥çœ‹è¿™ç¯‡[çº¯å¹²è´§ï¼Docker Dockerfile æŒ‡ä»¤å¤§å…¨](https://link.juejin.cn/?target=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F419175543)



**æŸ¥çœ‹æœ¬åœ°é•œåƒ**

```shell
# åˆ—å‡ºæœ¬åœ°é•œåƒ
docker images [OPTIONS] [REPOSITORY[:TAG]]

-a :åˆ—å‡ºæœ¬åœ°æ‰€æœ‰çš„é•œåƒï¼ˆå«ä¸­é—´æ˜ åƒå±‚ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œè¿‡æ»¤æ‰ä¸­é—´æ˜ åƒå±‚ï¼‰ï¼›
--digests :æ˜¾ç¤ºé•œåƒçš„æ‘˜è¦ä¿¡æ¯ï¼›
-f :æ˜¾ç¤ºæ»¡è¶³æ¡ä»¶çš„é•œåƒï¼›
--format :æŒ‡å®šè¿”å›å€¼çš„æ¨¡æ¿æ–‡ä»¶ï¼›
--no-trunc :æ˜¾ç¤ºå®Œæ•´çš„é•œåƒä¿¡æ¯ï¼›
-q :åªæ˜¾ç¤ºé•œåƒIDã€‚

# ä¾‹ï¼š
docker images # æŸ¥çœ‹æœ¬åœ°é•œåƒåˆ—è¡¨
docker images ubuntu # åˆ—å‡ºæœ¬åœ°é•œåƒä¸­REPOSITORYä¸ºubuntuçš„é•œåƒåˆ—è¡¨
```



**åˆ é™¤æœ¬åœ°é•œåƒ**

```shell
# åˆ é™¤æœ¬åœ°ä¸€ä¸ªæˆ–å¤šä¸ªé•œåƒ
docker rmi [OPTIONS] IMAGE [IMAGE...]

-f :å¼ºåˆ¶åˆ é™¤ï¼›
--no-prune :ä¸ç§»é™¤è¯¥é•œåƒçš„è¿‡ç¨‹é•œåƒï¼Œé»˜è®¤ç§»é™¤ï¼›

# ä¾‹ï¼š
docker rmi mysql:5.7 # ä½¿ç”¨é•œåƒå:ç‰ˆæœ¬å·tagåˆ é™¤
docker rmi 2be84dd575ee # ä½¿ç”¨é•œåƒIDåˆ é™¤
docker rmi `docker images -f "dangling=true" -q` # åˆ é™¤tagä¸ºnoneçš„é•œåƒ
docker rmi `docker images -q` # å…¨éƒ¨åˆ é™¤æœ¬åœ°é•œåƒ
```

> tip:
> ä¸ºäº†å‡†ç¡®åˆ é™¤ä½ çš„ç›®æ ‡é•œåƒ, å»ºè®®åˆ é™¤æœ‰å¤šä¸ªç‰ˆæœ¬å­˜åœ¨çš„é•œåƒæ—¶, ä½¿ç”¨é•œåƒå:ç‰ˆæœ¬å·, å¦‚æœäºŒè€…é•œåƒ `ID` ä¸åŒä¹Ÿå¯ä»¥ä½¿ç”¨é•œåƒ `ID` è¿›è¡Œåˆ é™¤, é˜²æ­¢è¯¯åˆ 
>
> ä¸èƒ½åˆ é™¤æ­£åœ¨è¿è¡Œçš„å®¹å™¨ä½¿ç”¨ç€çš„é•œåƒ(å‡å¦‚æ˜¯`nginx`é•œåƒ), å¦‚æœç¡®å®æƒ³è¦åˆ é™¤`nginx`, éœ€è¦å…ˆåœæ­¢æ‰€æœ‰ä½¿ç”¨è¿™ä¸ªé•œåƒçš„å®¹å™¨, å¹¶ä¸”å°†è¿™äº›å®¹å™¨åˆ é™¤, æ‰å¯ä»¥åˆ é™¤`nginx`é•œåƒã€‚



**å¯¼å‡ºé•œåƒ**

```bash
# å°†æŒ‡å®šé•œåƒä¿å­˜æˆ tar å½’æ¡£æ–‡ä»¶
docker save [OPTIONS] IMAGE [IMAGE...]

-o :è¾“å‡ºåˆ°çš„æ–‡ä»¶ã€‚

# ä¾‹ï¼š
docker save -o my_ubuntu_v3.tar runoob/ubuntu:v3
```



**å¯¼å…¥é•œåƒ**

```shell
# å¯¼å…¥ä½¿ç”¨ docker save å‘½ä»¤å¯¼å‡ºçš„é•œåƒ
docker load [OPTIONS]

--input , -i : æŒ‡å®šå¯¼å…¥çš„æ–‡ä»¶ï¼Œä»£æ›¿ STDINã€‚
--quiet , -q : ç²¾ç®€è¾“å‡ºä¿¡æ¯ã€‚

# ä¾‹ï¼š
docker load -i fedora.tar
```

> tip:
> å¦‚æœç”¨é•œåƒ `ID` å¯¼å‡ºçš„é•œåƒåœ¨å¯¼å…¥ä¹‹åæ˜¯æ²¡æœ‰åå­—å’Œ`tag`çš„, è¿™ç§æƒ…å†µæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ `docker tag` ç»™é•œåƒæ”¹åå­—
>
> ```shell
> docker tag image_id new_image_name:tag
> ```



## å®¹å™¨ç›¸å…³å‘½ä»¤

**åˆ›å»ºå®¹å™¨**

```shell
# åˆ›å»ºä¸€ä¸ªæ–°çš„å®¹å™¨å¹¶è¿è¡Œä¸€ä¸ªå‘½ä»¤
docker run [OPTIONS] IMAGE [COMMAND] [ARG...]

-a stdin: æŒ‡å®šæ ‡å‡†è¾“å…¥è¾“å‡ºå†…å®¹ç±»å‹ï¼Œå¯é€‰ STDIN/STDOUT/STDERR ä¸‰é¡¹ï¼›
-d: åå°è¿è¡Œå®¹å™¨ï¼Œå¹¶è¿”å›å®¹å™¨IDï¼›
-i: ä»¥äº¤äº’æ¨¡å¼è¿è¡Œå®¹å™¨ï¼Œé€šå¸¸ä¸ -t åŒæ—¶ä½¿ç”¨ï¼›
-P: éšæœºç«¯å£æ˜ å°„ï¼Œå®¹å™¨å†…éƒ¨ç«¯å£éšæœºæ˜ å°„åˆ°ä¸»æœºçš„ç«¯å£
-p: æŒ‡å®šç«¯å£æ˜ å°„ï¼Œæ ¼å¼ä¸ºï¼šä¸»æœº(å®¿ä¸»)ç«¯å£:å®¹å™¨ç«¯å£
-t: ä¸ºå®¹å™¨é‡æ–°åˆ†é…ä¸€ä¸ªä¼ªè¾“å…¥ç»ˆç«¯ï¼Œé€šå¸¸ä¸ -i åŒæ—¶ä½¿ç”¨ï¼›
--name="nginx-lb": ä¸ºå®¹å™¨æŒ‡å®šä¸€ä¸ªåç§°ï¼›
--dns 8.8.8.8: æŒ‡å®šå®¹å™¨ä½¿ç”¨çš„DNSæœåŠ¡å™¨ï¼Œé»˜è®¤å’Œå®¿ä¸»ä¸€è‡´ï¼›
--dns-search example.com: æŒ‡å®šå®¹å™¨DNSæœç´¢åŸŸåï¼Œé»˜è®¤å’Œå®¿ä¸»ä¸€è‡´ï¼›
-h "mars": æŒ‡å®šå®¹å™¨çš„hostnameï¼›
-e username="ritchie": è®¾ç½®ç¯å¢ƒå˜é‡ï¼›
--env-file=[]: ä»æŒ‡å®šæ–‡ä»¶è¯»å…¥ç¯å¢ƒå˜é‡ï¼›
--cpuset="0-2" or --cpuset="0,1,2": ç»‘å®šå®¹å™¨åˆ°æŒ‡å®šCPUè¿è¡Œï¼›
-m :è®¾ç½®å®¹å™¨ä½¿ç”¨å†…å­˜æœ€å¤§å€¼ï¼›
--net="bridge": æŒ‡å®šå®¹å™¨çš„ç½‘ç»œè¿æ¥ç±»å‹ï¼Œæ”¯æŒ bridge/host/none/container: å››ç§ç±»å‹ï¼›
--link=[]: æ·»åŠ é“¾æ¥åˆ°å¦ä¸€ä¸ªå®¹å™¨ï¼›
--expose=[]: å¼€æ”¾ä¸€ä¸ªç«¯å£æˆ–ä¸€ç»„ç«¯å£ï¼›
--volume , -v: ç»‘å®šä¸€ä¸ªå·ï¼Œæ ¼å¼ä¸ºï¼šä¸»æœº(å®¿ä¸»)å·:å®¹å™¨å·

# ä¾‹ï¼š
# ä½¿ç”¨dockeré•œåƒnginx:latestä»¥åå°æ¨¡å¼å¯åŠ¨ä¸€ä¸ªå®¹å™¨,å¹¶å°†å®¹å™¨å‘½åä¸ºmynginxã€‚
docker run --name mynginx -d nginx:latest

# ä½¿ç”¨é•œåƒnginx:latestä»¥åå°æ¨¡å¼å¯åŠ¨ä¸€ä¸ªå®¹å™¨,å¹¶å°†å®¹å™¨çš„80ç«¯å£æ˜ å°„åˆ°ä¸»æœºéšæœºç«¯å£ã€‚
docker run -P -d nginx:latest

# ä½¿ç”¨é•œåƒ nginx:latestï¼Œä»¥åå°æ¨¡å¼å¯åŠ¨ä¸€ä¸ªå®¹å™¨,å°†å®¹å™¨çš„ 80 ç«¯å£æ˜ å°„åˆ°ä¸»æœºçš„ 80 ç«¯å£,ä¸»æœºçš„ç›®å½• /data æ˜ å°„åˆ°å®¹å™¨çš„ /dataã€‚
docker run -p 80:80 -v /data:/data -d nginx:latest

# ç»‘å®šå®¹å™¨çš„ 8080 ç«¯å£ï¼Œå¹¶å°†å…¶æ˜ å°„åˆ°æœ¬åœ°ä¸»æœº 127.0.0.1 çš„ 80 ç«¯å£ä¸Šã€‚
docker run -p 127.0.0.1:80:8080/tcp ubuntu bash

# ä½¿ç”¨é•œåƒnginx:latestä»¥äº¤äº’æ¨¡å¼å¯åŠ¨ä¸€ä¸ªå®¹å™¨,åœ¨å®¹å™¨å†…æ‰§è¡Œ/bin/bashå‘½ä»¤
docker run -it nginx:latest /bin/bash
```

> tip:
> ä½¿ç”¨äº¤äº’æ¨¡å¼è¿è¡Œå®¹å™¨æ—¶, ä¼šç›´æ¥è¿›å…¥å®¹å™¨å†…éƒ¨, é€€å‡ºäº¤äº’æ¨¡å¼å, è¯¥å®¹å™¨è‡ªåŠ¨åœæ­¢è¿è¡Œ



**æŸ¥çœ‹å®¹å™¨åˆ—è¡¨**

```shell
# åˆ—å‡ºå®¹å™¨
docker ps [OPTIONS]

-a :æ˜¾ç¤ºæ‰€æœ‰çš„å®¹å™¨ï¼ŒåŒ…æ‹¬æœªè¿è¡Œçš„ã€‚
-f :æ ¹æ®æ¡ä»¶è¿‡æ»¤æ˜¾ç¤ºçš„å†…å®¹ã€‚
--format :æŒ‡å®šè¿”å›å€¼çš„æ¨¡æ¿æ–‡ä»¶ã€‚
-l :æ˜¾ç¤ºæœ€è¿‘åˆ›å»ºçš„å®¹å™¨ã€‚
-n :åˆ—å‡ºæœ€è¿‘åˆ›å»ºçš„nä¸ªå®¹å™¨ã€‚
--no-trunc :ä¸æˆªæ–­è¾“å‡ºã€‚
-q :é™é»˜æ¨¡å¼ï¼Œåªæ˜¾ç¤ºå®¹å™¨ç¼–å·ã€‚
-s :æ˜¾ç¤ºæ€»çš„æ–‡ä»¶å¤§å°

# ä¾‹ï¼š
docker ps # æŸ¥çœ‹æ­£åœ¨è¿è¡Œçš„å®¹å™¨åˆ—è¡¨
docker ps -l # æŸ¥çœ‹æœ€è¿‘ä¸€æ¬¡åˆ›å»ºçš„å®¹å™¨
docker ps -a # æŸ¥çœ‹å…¨éƒ¨å®¹å™¨(åŒ…æ‹¬å·²ç»åœæ­¢çš„å®¹å™¨)
```

> tip:
>
> STATUS: å®¹å™¨çŠ¶æ€ã€‚ çŠ¶æ€æœ‰7ç§ï¼š
>
> createdï¼ˆå·²åˆ›å»ºï¼‰
>
> restartingï¼ˆé‡å¯ä¸­ï¼‰
>
> runningï¼ˆè¿è¡Œä¸­ï¼‰
>
> removingï¼ˆè¿ç§»ä¸­ï¼‰
>
> pausedï¼ˆæš‚åœï¼‰
>
> exitedï¼ˆåœæ­¢ï¼‰
>
> deadï¼ˆæ­»äº¡ï¼‰
>
> è¿™äº›çŠ¶æ€ä¸­ï¼Œæœ€é‡è¦å’Œå¸¸è§çš„æ˜¯é™¤äº†restartingï¼ˆé‡å¯ä¸­ï¼‰å’Œremovingï¼ˆè¿ç§»ä¸­ï¼‰ä¹‹å¤–çš„äº”ä¸ªçŠ¶æ€ï¼Œä¸‹é¢åŸºæœ¬ä¸Šç½‘ç»œä¸Šå¤§éƒ¨åˆ†çš„å®¹å™¨ç”Ÿå‘½å‘¨æœŸå›¾éƒ½åªåŒ…å«äº”ä¸ªçŠ¶æ€ï¼šcreatedï¼ˆå·²åˆ›å»ºï¼‰ï¼Œrunningï¼ˆè¿è¡Œä¸­ï¼‰ï¼Œpausedï¼ˆæš‚åœï¼‰ï¼Œexitedï¼ˆåœæ­¢ï¼‰ï¼Œdeadï¼ˆæ­»äº¡ï¼‰ã€‚



**å¯åŠ¨/åœæ­¢/é‡å¯è¿è¡Œçš„å®¹å™¨**

```shell
# docker start :å¯åŠ¨ä¸€ä¸ªæˆ–å¤šä¸ªå·²ç»è¢«åœæ­¢çš„å®¹å™¨
# docker stop :åœæ­¢ä¸€ä¸ªè¿è¡Œä¸­çš„å®¹å™¨
# docker restart :é‡å¯å®¹å™¨

docker start [OPTIONS] CONTAINER [CONTAINER...]
docker stop [OPTIONS] CONTAINER [CONTAINER...]
docker restart [OPTIONS] CONTAINER [CONTAINER...]

# ä¾‹ï¼š
docker start my_container # ç”¨å®¹å™¨åå¯åŠ¨
docker start container_id # ç”¨å®¹å™¨IDå¯åŠ¨
docker start `docker ps -aq` # ç”¨å®¹å™¨IDå¯åŠ¨å¤šä¸ªå·²åœæ­¢çš„å®¹å™¨

docker stop my_container # ç”¨å®¹å™¨ååœæ­¢
docker stop container_id # ç”¨å®¹å™¨IDåœæ­¢
docker stop `docker ps -q` # ä½¿ç”¨å®¹å™¨IDåœæ­¢å¤šä¸ªæ­£åœ¨è¿è¡Œçš„å®¹å™¨

docker rm my_container # ç”¨å®¹å™¨ååˆ é™¤
docker rm container_id # ç”¨å®¹å™¨IDåˆ é™¤
docker rm `docker ps -aq` # åˆ é™¤å¤šä¸ªæœªè¿è¡Œçš„å®¹å™¨, è¿è¡Œä¸­çš„æ— æ³•åˆ é™¤
```



**è¿›å…¥å®¹å™¨æ‰§è¡Œå‘½ä»¤**(æ­£åœ¨è¿è¡Œçš„å®¹å™¨æ‰å¯ä»¥è¿›å…¥)

```shell
# åœ¨è¿è¡Œçš„å®¹å™¨ä¸­æ‰§è¡Œå‘½ä»¤
docker exec [OPTIONS] CONTAINER COMMAND [ARG...]

-d :åˆ†ç¦»æ¨¡å¼: åœ¨åå°è¿è¡Œ
-i :å³ä½¿æ²¡æœ‰é™„åŠ ä¹Ÿä¿æŒSTDIN æ‰“å¼€
-t :åˆ†é…ä¸€ä¸ªä¼ªç»ˆç«¯

# ä¾‹ï¼š
# åœ¨å®¹å™¨ mynginx ä¸­ä»¥äº¤äº’æ¨¡å¼æ‰§è¡Œå®¹å™¨å†… /root/runoob.sh è„šæœ¬
docker exec -it mynginx /bin/sh /root/runoob.sh

# åœ¨å®¹å™¨ my_container ä¸­å¼€å¯ä¸€ä¸ªäº¤äº’æ¨¡å¼çš„ç»ˆç«¯
docker exec -it my_container /bin/bash # ä½¿ç”¨å®¹å™¨å
docker exec -it container_id /bin/bash # ä½¿ç”¨å®¹å™¨ID
```



**æŸ¥çœ‹å®¹å™¨ä¿¡æ¯**

```bash
# è·å–å®¹å™¨/é•œåƒçš„å…ƒæ•°æ®
docker inspect [OPTIONS] NAME|ID [NAME|ID...]

-f :æŒ‡å®šè¿”å›å€¼çš„æ¨¡æ¿æ–‡ä»¶ã€‚
-s :æ˜¾ç¤ºæ€»çš„æ–‡ä»¶å¤§å°ã€‚
--type :ä¸ºæŒ‡å®šç±»å‹è¿”å›JSON

# ä¾‹ï¼š
docker inspect my_container:version_tag # å®¹å™¨å
docker inspect container_id # å®¹å™¨ID
```

å†…å®¹å¾ˆå¤š

![docker-inspect.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6fae54d11c904fc1973f73e7390ca6fb~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp?)



**å®¹å™¨ä¸å®¿ä¸»æœºä¹‹é—´çš„æ•°æ®æ‹·è´**

```shell
# ç”¨äºå®¹å™¨ä¸ä¸»æœºä¹‹é—´çš„æ•°æ®æ‹·è´ã€‚
docker cp [OPTIONS] CONTAINER:SRC_PATH DEST_PATH|-
docker cp [OPTIONS] SRC_PATH|- CONTAINER:DEST_PATH

-L :ä¿æŒæºç›®æ ‡ä¸­çš„é“¾æ¥

# ä¾‹ï¼š
# 1ã€å°†å®¹å™¨ä¸­ç›®å½•æˆ–æ–‡ä»¶æ‹·è´åˆ°å®¿ä¸»æœº
# å°†å®¹å™¨ä¸­ /app/html ç›®å½•æ‹·è´åˆ°å®¿ä¸»æœº /mnt/ ç›®å½•ä¸­
docker cp container_id:/app/html /mnt/

# 2ã€å°†å®¿ä¸»æœºç›®å½•æˆ–æ–‡ä»¶æ‹·è´åˆ°å®¹å™¨ä¸­
# å°†å®¿ä¸»æœº /mnt/dist ç›®å½•æ‹·è´åˆ°å®¹å™¨çš„ /app ç›®å½•ä¸­
docker cp /mnt/dist container_id:/app/

# 3ã€å°†å®¿ä¸»æœº/mnt/distç›®å½•æ‹·è´åˆ°å®¹å™¨ä¸­, å¹¶é‡å‘½åä¸ºhtml
# å°†å®¿ä¸»æœº /mnt/dist ç›®å½•æ‹·è´åˆ°å®¹å™¨çš„ /app/ ä¸­é‡å‘½åä¸º html
docker cp /mnt/dist container_id:/app/html
# å°†å®¿ä¸»æœº /mnt/dist/index1.html æ–‡ä»¶æ‹·è´åˆ°å®¹å™¨çš„ /app/html/ ä¸­é‡å‘½åä¸º index.html
docker cp /mnt/dist/index1.html container_id:/app/html/index.html
```

