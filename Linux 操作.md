[toc]

# Linux 操作

## Terminal 中杀掉进程

在终端（terminal）中杀掉进程的方法主要有以下几种，取决于你知道进程的什么信息：

**一、已知进程名时杀掉进程**

使用 `pkill` 命令：

```bash
pkill <进程名>

# 例如：
pkill firefox
```

如果想更安全地匹配名字（避免误杀）：

```bash
pkill -f "完整命令行内容的一部分"
```

**二、已知进程 ID（PID）时杀掉进程**

使用 `kill` 命令：

```bash
kill <PID>

# 例如：
kill 12345
```

如果进程不响应（顽固），可以强制杀死：

```bash
kill -9 <PID>
```

**三、查找并杀掉进程（推荐组合）**

用 `ps` 或 `top` 查找 PID 后再杀掉进程：

```bash
ps aux | grep <关键字>

# 例如：
ps aux | grep python
```

找到 PID 后，使用 `kill` 或 `kill -9` 杀掉它。

也可以结合 `ps` 和 `awk`：

```bash
ps aux | grep <关键字> | grep -v grep | awk '{print $2}' | xargs kill
# 或强制杀掉：
ps aux | grep <关键字> | grep -v grep | awk '{print $2}' | xargs kill -9
```

**四、 使用 `htop`（更友好）**

安装并运行 `htop`：

```bash
sudo apt install htop    # Debian/Ubuntu
htop
```

然后用方向键选择进程，按 `F9`，选择 `SIGKILL` 杀掉。

**注意事项**

- 使用 `kill -9` 杀进程虽然暴力，但**不会给程序清理资源的机会**，慎用。
- `pkill` 默认会杀所有匹配名的进程，如果名字不唯一要小心。

## kill 命令

`kill` 通过 **发送信号** 给指定的进程（PID）来控制其行为，最常用于“杀掉进程”，但实际上它也可以发送其他信号（如暂停、继续、重新加载配置等）。

**常见语法：**

```bash
kill [选项] PID
```

- 默认发送 `SIGTERM`（15）信号，表示“请求终止”
- 强制终止用 `SIGKILL`（9）
- 查看信号列表：`kill -l`

**常用信号：**

| 信号名  | 数字 | 含义              | 说明                           |
| ------- | ---- | ----------------- | ------------------------------ |
| SIGTERM | 15   | 优雅地终止        | 默认行为，让进程有机会清理资源 |
| SIGKILL | 9    | 强制终止          | 无法被捕获或忽略，**直接终止** |
| SIGHUP  | 1    | 挂起/重新加载配置 | 常用于守护进程重读配置         |
| SIGSTOP | 19   | 暂停进程          | 类似 Ctrl+Z                    |
| SIGCONT | 18   | 恢复被暂停的进程  | 和 SIGSTOP 配合使用            |

**示例用法：**

```bash
kill 1234                  # 发送 SIGTERM，优雅终止
kill -9 1234               # 强制杀死进程
kill -SIGSTOP 1234         # 暂停进程
kill -SIGCONT 1234         # 恢复进程
```

**使用场景：**

- **已知 PID 的时候**最适合用 `kill`
- 用于**控制进程状态**（暂停、恢复）
- 用于**安全退出某些服务**（使用 SIGTERM 或 SIGHUP）

## pkill 命令

`pkill` 用于通过 **进程名或命令匹配**来终止进程，不需要知道 PID。`pkill` 允许通过进程名、用户、组或其他属性来查找和杀死进程，这使得它比 `kill` 更方便，尤其是在需要杀死多个同名进程时。

```bash
pkill [选项] <匹配条件>
```

- `选项`: `pkill` 有许多选项，用于指定匹配方式和发送的信号。
- `匹配条件`: 这是要匹配的进程名或属性，可以是精确的名称，也可以是使用正则表达式的模式。

**常用选项：**

| 选项     | 含义                                               |
| -------- | -------------------------------------------------- |
| `-f`     | 匹配完整命令行（包含参数）                         |
| `-<sig>` | 指定信号，如 `-9` 强制杀死进程（等价于 `kill -9`） |
| `-u`     | 指定用户杀掉进程                                   |
| `-t`     | 指定终端杀掉进程                                   |
| `-x`     | 完整匹配进程名                                     |
| `-n`     | 只向找到的最大(结束) 进程号发送信号                |
| `-o`     | 只向找到的最小(起始) 进程号发送信号                |

**示例用法：**

```bash
pkill firefox             # 杀掉所有名为 firefox 的进程
pkill -f "python myapp.py"  # 精确匹配命令行中包含“python myapp.py”的进程
pkill -9 python           # 强制杀掉所有 python 进程
pkill -u alice chrome     # 杀掉用户 alice 的 chrome
pkill -t pts/0            # 杀死终端 `pts/0` 的所有进程
```

**使用场景：**

- **根据进程名终止进程**：如 `pkill firefox` 杀死所有名为 `firefox` 的进程。

- **模糊匹配杀死进程**: `pkill` 支持模糊匹配，如 `pkill fire` 可能会杀死所有以 `fire` 开头的进程。

- **支持信号**: `pkill` 默认发送 `SIGTERM` 信号来终止进程，但您也可以使用 `-s` 选项发送其他信号，例如 `SIGKILL` (强制终止)。

- **支持其他属性**: 除了进程名，`pkill` 还可以根据用户、组、终端等属性来匹配和杀死进程。

## `kill` vs `pkill`

| 项   | `kill`               | `pkill`                      |
| ---- | -------------------- | ---------------------------- |
| 依据 | PID（数字）          | 进程名、命令行内容等         |
| 优点 | 精确控制，适合脚本化 | 快捷模糊匹配，适合人手操作   |
| 缺点 | 需要先查 PID         | 可能误杀进程（需小心匹配）   |
| 场景 | 已知 PID、写脚本     | 杀掉一类进程、快速命令行处理 |
| 示例 | `kill -9 1234`       | `pkill -9 python`            |
